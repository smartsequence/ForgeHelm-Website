---
import Layout from '../../layouts/Layout.astro';
import { getTranslations, getLocalizedPath } from '../../i18n/utils';
import { defaultLang, type Language, getAllLanguageCodes } from '../../i18n/languages';

// ç”Ÿæˆæ‰€æœ‰èªè¨€ç‰ˆæœ¬çš„éœæ…‹è·¯å¾‘
export async function getStaticPaths() {
	const allLangs = getAllLanguageCodes();
	return allLangs
		.filter((lang) => lang !== defaultLang)
		.map((lang) => ({
			params: { lang },
		}));
}

// å¾ URL åƒæ•¸å–å¾—èªè¨€
const lang = (Astro.params.lang || defaultLang) as Language;
const translations = await getTranslations(lang);

// ç²å– source åƒæ•¸
const source = Astro.url.searchParams.get('source') || 'direct';
const plan = Astro.url.searchParams.get('plan') || '';

// ç¿»è­¯å‡½å¼
function t(key: string): string {
	const keys = key.split('.');
	let value: any = translations;
	for (const k of keys) {
		value = value?.[k];
		if (value === undefined) return key;
	}
	return value || key;
}
---

<Layout 
	title={t('pages.getStarted.title')}
	description={t('pages.getStarted.description')}
>
	<!-- Hero å€å¡Š -->
	<section class="hero">
		<div class="container">
			<h1>{t('pages.getStarted.heroTitle')}</h1>
			<p class="hero-subtitle">
				{t('pages.getStarted.heroSubtitle')}
			</p>
		</div>
	</section>

	<!-- é¸é …å¡ç‰‡ -->
	<section class="section options">
		<div class="container">
			<div class="options-grid">
				<!-- å…è²»è©¦ç”¨ -->
				<div class="option-card">
					<div class="card-badge free">{lang === 'en' ? 'Free' : 'å…è²»'}</div>
					<h2>{t('pages.getStarted.optionTrialTitle')}</h2>
					<p class="card-description">
						{t('pages.getStarted.optionTrialDesc')}
					</p>
					<ul class="card-features">
						<li>âœ“ {t('pages.getStarted.optionTrialFeature1')}</li>
						<li>âœ“ {t('pages.getStarted.optionTrialFeature2')}</li>
						<li>âœ“ {t('pages.getStarted.optionTrialFeature3')}</li>
						<li>âœ“ {t('pages.getStarted.optionTrialFeature4')}</li>
					</ul>
					<a href={`https://app.forgehelm.com/trial?source=${source}`} class="card-btn">{t('pages.getStarted.optionTrialButton')}</a>
					<p class="card-note">{t('pages.getStarted.optionTrialNote')}</p>
				</div>

				<!-- ç›´æ¥è³¼è²· -->
				<div class="option-card featured">
					<div class="card-badge popular">{lang === 'en' ? 'Most Popular' : 'æœ€å—æ­¡è¿'}</div>
					<h2>{t('pages.getStarted.optionPricingTitle')}</h2>
					<p class="card-description">
						{t('pages.getStarted.optionPricingDesc')}
					</p>
					<ul class="card-features">
						<li>âœ“ {lang === 'en' ? 'Single purchase $29' : 'å–®æ¬¡è³¼è²· NT$ 990'}</li>
						<li>âœ“ {lang === 'en' ? 'Monthly plan $79' : 'æœˆåº¦æ–¹æ¡ˆ NT$ 2,490'}</li>
						<li>âœ“ {lang === 'en' ? 'Annual plan $799' : 'å¹´åº¦æ–¹æ¡ˆ NT$ 24,900'}</li>
						<li>âœ“ {lang === 'en' ? 'All plans can issue invoices' : 'æ‰€æœ‰æ–¹æ¡ˆå¯é–‹ç™¼ç¥¨'}</li>
					</ul>
					<a href={getLocalizedPath(`/pricing?source=${source}`, lang)} class="card-btn primary">{t('pages.getStarted.optionPricingButton')}</a>
					<p class="card-note">{t('pages.getStarted.optionPricingNote')}</p>
				</div>

				<!-- ä¼æ¥­è«®è©¢ -->
				<div class="option-card">
					<div class="card-badge enterprise">{lang === 'en' ? 'Enterprise' : 'ä¼æ¥­'}</div>
					<h2>{lang === 'en' ? 'Enterprise Customization' : 'ä¼æ¥­å®¢è£½åŒ–'}</h2>
					<p class="card-description">
						{lang === 'en' 
							? 'Need large volumes of reports, customized analysis, or training? We offer dedicated enterprise plans'
							: 'éœ€è¦å¤§é‡å ±å‘Šã€å®¢è£½åŒ–åˆ†ææˆ–æ•™è‚²è¨“ç·´ï¼Ÿæˆ‘å€‘æä¾›å°ˆå±¬ä¼æ¥­æ–¹æ¡ˆ'}
					</p>
					<ul class="card-features">
						<li>âœ“ {lang === 'en' ? 'Customized analysis dimensions' : 'å®¢è£½åŒ–åˆ†æç¶­åº¦'}</li>
						<li>âœ“ {lang === 'en' ? 'Dedicated technical support' : 'å°ˆå±¬æŠ€è¡“æ”¯æ´'}</li>
						<li>âœ“ {lang === 'en' ? 'Training services' : 'æ•™è‚²è¨“ç·´æœå‹™'}</li>
						<li>âœ“ {lang === 'en' ? 'Flexible pricing' : 'å½ˆæ€§è¨ˆè²»æ–¹å¼'}</li>
					</ul>
					<a href={getLocalizedPath(`/contact?type=enterprise&source=${source}`, lang)} class="card-btn">{lang === 'en' ? 'Contact Us' : 'è¯çµ¡æˆ‘å€‘è«®è©¢'}</a>
					<p class="card-note">{lang === 'en' ? 'Suitable for large enterprises' : 'é©åˆå¤§å‹ä¼æ¥­'}</p>
				</div>
			</div>
		</div>
	</section>

	<!-- å¿«é€Ÿé€£çµ -->
	<section class="section quick-links">
		<div class="container">
			<h2 class="section-title">{lang === 'en' ? 'Still Have Questions?' : 'é‚„æœ‰å•é¡Œï¼Ÿ'}</h2>
			
			<div class="links-grid">
				<a href={getLocalizedPath('/features', lang)} class="link-card">
					<div class="link-icon">âš™ï¸</div>
					<h3>{lang === 'en' ? 'Learn About Features' : 'ç­è§£åŠŸèƒ½ç‰¹è‰²'}</h3>
					<p>{lang === 'en' ? 'View ForgeHelm\'s six core features' : 'æŸ¥çœ‹ ForgeHelm çš„å…­å¤§æ ¸å¿ƒåŠŸèƒ½'}</p>
				</a>

				<a href={getLocalizedPath('/pricing#faq', lang)} class="link-card">
					<div class="link-icon">â“</div>
					<h3>{lang === 'en' ? 'FAQ' : 'å¸¸è¦‹å•é¡Œ'}</h3>
					<p>{lang === 'en' ? 'Invoice, payment, data security questions' : 'ç™¼ç¥¨ã€ä»˜æ¬¾ã€è³‡æ–™å®‰å…¨ç­‰ç–‘å•'}</p>
				</a>

				<a href={getLocalizedPath('/contact', lang)} class="link-card">
					<div class="link-icon">ğŸ“§</div>
					<h3>{lang === 'en' ? 'Contact Us' : 'è¯çµ¡æˆ‘å€‘'}</h3>
					<p>{lang === 'en' ? 'Feel free to ask any questions' : 'æœ‰ä»»ä½•å•é¡Œéƒ½æ­¡è¿è©¢å•'}</p>
				</a>
			</div>
		</div>
	</section>
</Layout>

<style>
	/* è¤‡è£½ get-started.astro çš„æ¨£å¼ */
	.hero {
		background: var(--bg-main);
		color: var(--text-primary);
		padding: 0.25rem 0 3rem;
		text-align: center;
		border-bottom: 1px solid var(--border-light);
	}

	.hero h1 {
		font-size: 2.5rem;
		margin-bottom: 1rem;
	}

	.hero-subtitle {
		font-size: 1.125rem;
		opacity: 0.95;
	}

	.options-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
		gap: 2rem;
		margin-top: 2rem;
	}

	.option-card {
		background: var(--bg-card);
		border: 2px solid var(--border-color);
		border-radius: 1rem;
		padding: 2.5rem 2rem;
		position: relative;
		display: flex;
		flex-direction: column;
		transition: all 0.2s ease;
	}

	.option-card:hover {
		transform: translateY(-4px);
		box-shadow: var(--shadow-lg);
	}

	.option-card.featured {
		border-color: var(--cta-primary);
		box-shadow: var(--shadow-md);
	}

	.card-badge {
		position: absolute;
		top: -12px;
		left: 50%;
		transform: translateX(-50%);
		padding: 0.375rem 1rem;
		border-radius: 1rem;
		font-size: 0.875rem;
		font-weight: 600;
		color: white;
	}

	.card-badge.free {
		background: var(--cta-success);
	}

	.card-badge.popular {
		background: var(--cta-primary);
	}

	.card-badge.enterprise {
		background: var(--bg-section);
		color: var(--text-primary);
		border: 1px solid var(--border-color);
	}

	.option-card h2 {
		font-size: 1.5rem;
		margin: 1rem 0;
		color: var(--text-primary);
	}

	.card-description {
		color: var(--text-secondary);
		margin-bottom: 1.5rem;
		line-height: 1.75;
	}

	.card-features {
		list-style: none;
		padding: 0;
		margin: 0 0 2rem 0;
		flex: 1;
	}

	.card-features li {
		padding: 0.5rem 0;
		color: var(--text-secondary);
	}

	.card-btn {
		display: block;
		text-align: center;
		padding: 0.875rem;
		background: transparent;
		border: 2px solid var(--border-color);
		color: var(--text-primary);
		text-decoration: none;
		border-radius: 0.5rem;
		font-weight: 600;
		transition: all 0.2s ease;
		margin-bottom: 1rem;
	}

	.card-btn:hover {
		background: var(--cta-primary);
		color: white;
		border-color: var(--cta-primary);
	}

	.card-btn.primary {
		background: var(--cta-primary);
		border-color: transparent;
		color: white;
	}

	.card-btn.primary:hover {
		transform: translateY(-2px);
		background: var(--cta-hover);
		box-shadow: var(--shadow-md);
	}

	.card-note {
		text-align: center;
		font-size: 0.875rem;
		color: var(--text-secondary);
		margin: 0;
	}

	.quick-links {
		background: var(--bg-section);
	}

	.section-title {
		text-align: center;
		font-size: 2.25rem;
		margin-bottom: 3rem;
		color: var(--text-primary);
	}

	.links-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
		gap: 1.5rem;
	}

	.link-card {
		background: var(--bg-card);
		padding: 2rem;
		border-radius: 1rem;
		border: 1px solid var(--border-color);
		text-decoration: none;
		transition: all 0.2s ease;
		display: block;
	}

	.link-card:hover {
		border-color: var(--cta-primary);
		transform: translateY(-2px);
		box-shadow: var(--shadow-md);
	}

	.link-icon {
		font-size: 2.5rem;
		margin-bottom: 1rem;
	}

	.link-card h3 {
		font-size: 1.125rem;
		margin-bottom: 0.5rem;
		color: var(--text-primary);
	}

	.link-card p {
		color: var(--text-secondary);
		margin: 0;
	}

	.section {
		padding: 5rem 0;
	}

	@media (max-width: 768px) {
		.hero h1 {
			font-size: 2rem;
		}

		.section {
			padding: 3rem 0;
		}

		.options-grid,
		.links-grid {
			grid-template-columns: 1fr;
		}
	}
</style>
